---
layout: default
title: Home
---

<div class="home-with-sidebar">
  <!-- Sidebar TOC -->
  <aside class="chronicles-sidebar">
    <h3>The Story</h3>

    {% assign chronicle_posts = site.posts | where_exp: "post", "post.tags contains 'chronicles'" | reverse %}
    {% assign chapters = chronicle_posts | group_by: "chapter" | sort: "name" %}

    {% for chapter_group in chapters %}
      <div class="chapter-section">
        <h4>{{ chapter_group.name | capitalize }}</h4>
        <ul class="chapter-parts">
          {% assign sorted_parts = chapter_group.items | sort: "part" %}
          {% for post in sorted_parts %}
            <li>
              <a href="{{ post.url | relative_url }}">
                {% if post.part %}Part {{ post.part }}:{% endif %}
                {{ post.title | remove: "Prologue: Part 1 - " | remove: "Prologue: Part 2 - " | remove: "Prologue: " }}
              </a>
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endfor %}
  </aside>

  <!-- Main content -->
  <div class="home">
    <h1>The Chronicles</h1>

    {% if site.posts.size > 0 %}
      <ul class="post-list">
        {% for post in site.posts %}
          {% unless post.tags contains 'off-story' %}
          <li class="post-item">
            <h2>
              <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
            </h2>

            <div class="post-meta">
              <time datetime="{{ post.date | date_to_xmlschema }}">{{ post.date | date: "%B %d, %Y" }}</time>
              {% if post.tags %}
                <div style="margin-top: 0.5rem;">
                  {% for tag in post.tags %}
                    <span class="tag">{{ tag }}</span>
                  {% endfor %}
                </div>
              {% endif %}
            </div>

            {% if post.excerpt %}
              <p class="excerpt">{{ post.excerpt | strip_html | truncatewords: 30 }}</p>
            {% endif %}

            <a href="{{ post.url | relative_url }}" class="read-more">Read more</a>
          </li>
          {% endunless %}
        {% endfor %}
      </ul>
    {% else %}
      <p>No posts yet.</p>
    {% endif %}
  </div>
</div>
